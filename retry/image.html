<!DOCTYPE html>
<html lang="zh_CN">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å›¾ç‰‡é‡åŠ è½½</title>
    <script>
      window.onerror = (ev) => {
        console.info(`%cğŸ‡¨ğŸ‡³script error: `, 'font-size:25px;color:deeppink;', ev);
        console.dir(ev);
      };
    </script>
  </head>
  <body>
    <img src="https://images.pexels.com/photos/1563355/pexels-photo-1563355.jpeg?auto=compress&cs=tinysrgb&w=1600" alt="åŠ è½½å¤±è´¥äº†" />

    <button>
      <h1>&nbsp;é‡&nbsp;è¯•&nbsp;</h1>
    </button>

    <script>
      function sleep(duration = 1000) {
        return new Promise((resolve, reject) => {
          setTimeout(() => {
            resolve(true);
          }, duration);
        });
      }

      function loadImage(src) {
        return new Promise((resolve, reject) => {
          const image = new Image();
          image.src = src;

          image.onload = () => {
            console.log('onload ');
            resolve('onload');
          };
          image.onerror = (err) => {
            console.log('onerror');
            reject(err);
          };
        });
      }

      const image = document.querySelector('img');
      image.onerror = async (err) => {
        console.log('img onerror ev: ', err);
        console.log('img html: ', image.complete);
      };

      // å›¾ç‰‡åŠ è½½å®Œæˆï¼Œæ‰€æœ‰çš„æ•°æ®å®Œæˆï¼Œä½†ä¸ä¸€å®šè§£ç æˆåŠŸ
      image.onload = () => {
        console.log('img onload');
      };

      image.onabort = () => {
        console.log('img abort');
      };
    </script>

    <script>
      const button = document.querySelector('button');
      button.onclick = async () => {
        console.log('click');
        loadImage('https://images.pexels.com/photos/1563355/pexels-photo-1563355.jpeg?auto=compress&cs=tinysrgb&w=1600').then(() => {
          console.log('æˆåŠŸå•¦');
          image.src = 'https://images.pexels.com/photos/1563355/pexels-photo-1563355.jpeg?auto=compress&cs=tinysrgb&w=1600';
          // åªè¦æ‰‹åŠ¨è®¾ç½® dom çš„srcï¼Œå°±ä¼šä½¿è§†é¢‘é‡æ–°è¯·æ±‚èµ„æºï¼Œæ— è®ºé“¾æ¥æ˜¯å¦ç›¸åŒã€‚

          //   video.load(); // ä¹Ÿä¼šé‡æ–°åŠ è½½èµ„æº  å’Œ video.src = 'xxx' æ˜¯ä¸€æ ·çš„
        });
      };

      function jsok(ev) {
        console.log('è„šæœ¬åŠ è½½OK');
      }
      function jserror(ev) {
        console.log('è„šæœ¬åŠ è½½ERROR', ev);
      }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js" onerror="jserror(event)" onload="jsok(event)"></script>
  </body>
</html>
